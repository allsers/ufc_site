import{s as Y,n as V,o as Z,e as se}from"../chunks/scheduler.B1soYl2W.js";import{S as X,i as K,e as q,c as M,z as W,o as D,g as F,d as L,s as P,u as oe,y as le,f as Q,a as fe,v as ae,h as z,w as ue,n as ce,l as _e,x as de,A as me}from"../chunks/index.Mel9JJoE.js";import{f as he}from"../chunks/index.Dkxe9Wte.js";import"../chunks/paths.ygrW6QDc.js";class _ extends Error{constructor(e,l,t,...n){Array.isArray(l)&&(l=l.join(" ").trim()),super(l),Error.captureStackTrace!==void 0&&Error.captureStackTrace(this,_),this.code=e;for(const o of n)for(const s in o){const i=o[s];this[s]=Buffer.isBuffer(i)?i.toString(t.encoding):i==null?i:JSON.parse(JSON.stringify(i))}}}const ge=function(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)},ee=function(r){const e=[];for(let l=0,t=r.length;l<t;l++){const n=r[l];if(n==null||n===!1)e[l]={disabled:!0};else if(typeof n=="string")e[l]={name:n};else if(ge(n)){if(typeof n.name!="string")throw new _("CSV_OPTION_COLUMNS_MISSING_NAME",["Option columns missing name:",`property "name" is required at position ${l}`,"when column is an object literal"]);e[l]=n}else throw new _("CSV_INVALID_COLUMN_DEFINITION",["Invalid column definition:","expect a string or a literal object,",`got ${JSON.stringify(n)} at position ${l}`])}return e};class U{constructor(e=100){this.size=e,this.length=0,this.buf=Buffer.allocUnsafe(e)}prepend(e){if(Buffer.isBuffer(e)){const l=this.length+e.length;if(l>=this.size&&(this.resize(),l>=this.size))throw Error("INVALID_BUFFER_STATE");const t=this.buf;this.buf=Buffer.allocUnsafe(this.size),e.copy(this.buf,0),t.copy(this.buf,e.length),this.length+=e.length}else{const l=this.length++;l===this.size&&this.resize();const t=this.clone();this.buf[0]=e,t.copy(this.buf,1,0,l)}}append(e){const l=this.length++;l===this.size&&this.resize(),this.buf[l]=e}clone(){return Buffer.from(this.buf.slice(0,this.length))}resize(){const e=this.length;this.size=this.size*2;const l=Buffer.allocUnsafe(this.size);this.buf.copy(l,0,0,e),this.buf=l}toString(e){return e?this.buf.slice(0,this.length).toString(e):Uint8Array.prototype.slice.call(this.buf.slice(0,this.length))}toJSON(){return this.toString("utf8")}reset(){this.length=0}}const pe=12,be=13,ye=10,we=32,Ie=9,Oe=function(r){return{bomSkipped:!1,bufBytesStart:0,castField:r.cast_function,commenting:!1,error:void 0,enabled:r.from_line===1,escaping:!1,escapeIsQuote:Buffer.isBuffer(r.escape)&&Buffer.isBuffer(r.quote)&&Buffer.compare(r.escape,r.quote)===0,expectedRecordLength:Array.isArray(r.columns)?r.columns.length:void 0,field:new U(20),firstLineToHeaders:r.cast_first_line_to_header,needMoreDataSize:Math.max(r.comment!==null?r.comment.length:0,...r.delimiter.map(e=>e.length),r.quote!==null?r.quote.length:0),previousBuf:void 0,quoting:!1,stop:!1,rawBuffer:new U(100),record:[],recordHasError:!1,record_length:0,recordDelimiterMaxLength:r.record_delimiter.length===0?0:Math.max(...r.record_delimiter.map(e=>e.length)),trimChars:[Buffer.from(" ",r.encoding)[0],Buffer.from("	",r.encoding)[0]],wasQuoting:!1,wasRowDelimiter:!1,timchars:[Buffer.from(Buffer.from([be],"utf8").toString(),r.encoding),Buffer.from(Buffer.from([ye],"utf8").toString(),r.encoding),Buffer.from(Buffer.from([pe],"utf8").toString(),r.encoding),Buffer.from(Buffer.from([we],"utf8").toString(),r.encoding),Buffer.from(Buffer.from([Ie],"utf8").toString(),r.encoding)]}},Se=function(r){return r.replace(/([A-Z])/g,function(e,l){return"_"+l.toLowerCase()})},H=function(r){const e={};for(const t in r)e[Se(t)]=r[t];if(e.encoding===void 0||e.encoding===!0)e.encoding="utf8";else if(e.encoding===null||e.encoding===!1)e.encoding=null;else if(typeof e.encoding!="string"&&e.encoding!==null)throw new _("CSV_INVALID_OPTION_ENCODING",["Invalid option encoding:","encoding must be a string or null to return a buffer,",`got ${JSON.stringify(e.encoding)}`],e);if(e.bom===void 0||e.bom===null||e.bom===!1)e.bom=!1;else if(e.bom!==!0)throw new _("CSV_INVALID_OPTION_BOM",["Invalid option bom:","bom must be true,",`got ${JSON.stringify(e.bom)}`],e);if(e.cast_function=null,e.cast===void 0||e.cast===null||e.cast===!1||e.cast==="")e.cast=void 0;else if(typeof e.cast=="function")e.cast_function=e.cast,e.cast=!0;else if(e.cast!==!0)throw new _("CSV_INVALID_OPTION_CAST",["Invalid option cast:","cast must be true or a function,",`got ${JSON.stringify(e.cast)}`],e);if(e.cast_date===void 0||e.cast_date===null||e.cast_date===!1||e.cast_date==="")e.cast_date=!1;else if(e.cast_date===!0)e.cast_date=function(t){const n=Date.parse(t);return isNaN(n)?t:new Date(n)};else if(typeof e.cast_date!="function")throw new _("CSV_INVALID_OPTION_CAST_DATE",["Invalid option cast_date:","cast_date must be true or a function,",`got ${JSON.stringify(e.cast_date)}`],e);if(e.cast_first_line_to_header=null,e.columns===!0)e.cast_first_line_to_header=void 0;else if(typeof e.columns=="function")e.cast_first_line_to_header=e.columns,e.columns=!0;else if(Array.isArray(e.columns))e.columns=ee(e.columns);else if(e.columns===void 0||e.columns===null||e.columns===!1)e.columns=!1;else throw new _("CSV_INVALID_OPTION_COLUMNS",["Invalid option columns:","expect an array, a function or true,",`got ${JSON.stringify(e.columns)}`],e);if(e.group_columns_by_name===void 0||e.group_columns_by_name===null||e.group_columns_by_name===!1)e.group_columns_by_name=!1;else{if(e.group_columns_by_name!==!0)throw new _("CSV_INVALID_OPTION_GROUP_COLUMNS_BY_NAME",["Invalid option group_columns_by_name:","expect an boolean,",`got ${JSON.stringify(e.group_columns_by_name)}`],e);if(e.columns===!1)throw new _("CSV_INVALID_OPTION_GROUP_COLUMNS_BY_NAME",["Invalid option group_columns_by_name:","the `columns` mode must be activated."],e)}if(e.comment===void 0||e.comment===null||e.comment===!1||e.comment==="")e.comment=null;else if(typeof e.comment=="string"&&(e.comment=Buffer.from(e.comment,e.encoding)),!Buffer.isBuffer(e.comment))throw new _("CSV_INVALID_OPTION_COMMENT",["Invalid option comment:","comment must be a buffer or a string,",`got ${JSON.stringify(e.comment)}`],e);if(e.comment_no_infix===void 0||e.comment_no_infix===null||e.comment_no_infix===!1)e.comment_no_infix=!1;else if(e.comment_no_infix!==!0)throw new _("CSV_INVALID_OPTION_COMMENT",["Invalid option comment_no_infix:","value must be a boolean,",`got ${JSON.stringify(e.comment_no_infix)}`],e);const l=JSON.stringify(e.delimiter);if(Array.isArray(e.delimiter)||(e.delimiter=[e.delimiter]),e.delimiter.length===0)throw new _("CSV_INVALID_OPTION_DELIMITER",["Invalid option delimiter:","delimiter must be a non empty string or buffer or array of string|buffer,",`got ${l}`],e);if(e.delimiter=e.delimiter.map(function(t){if(t==null||t===!1)return Buffer.from(",",e.encoding);if(typeof t=="string"&&(t=Buffer.from(t,e.encoding)),!Buffer.isBuffer(t)||t.length===0)throw new _("CSV_INVALID_OPTION_DELIMITER",["Invalid option delimiter:","delimiter must be a non empty string or buffer or array of string|buffer,",`got ${l}`],e);return t}),e.escape===void 0||e.escape===!0?e.escape=Buffer.from('"',e.encoding):typeof e.escape=="string"?e.escape=Buffer.from(e.escape,e.encoding):(e.escape===null||e.escape===!1)&&(e.escape=null),e.escape!==null&&!Buffer.isBuffer(e.escape))throw new Error(`Invalid Option: escape must be a buffer, a string or a boolean, got ${JSON.stringify(e.escape)}`);if(e.from===void 0||e.from===null)e.from=1;else if(typeof e.from=="string"&&/\d+/.test(e.from)&&(e.from=parseInt(e.from)),Number.isInteger(e.from)){if(e.from<0)throw new Error(`Invalid Option: from must be a positive integer, got ${JSON.stringify(r.from)}`)}else throw new Error(`Invalid Option: from must be an integer, got ${JSON.stringify(e.from)}`);if(e.from_line===void 0||e.from_line===null)e.from_line=1;else if(typeof e.from_line=="string"&&/\d+/.test(e.from_line)&&(e.from_line=parseInt(e.from_line)),Number.isInteger(e.from_line)){if(e.from_line<=0)throw new Error(`Invalid Option: from_line must be a positive integer greater than 0, got ${JSON.stringify(r.from_line)}`)}else throw new Error(`Invalid Option: from_line must be an integer, got ${JSON.stringify(r.from_line)}`);if(e.ignore_last_delimiters===void 0||e.ignore_last_delimiters===null)e.ignore_last_delimiters=!1;else if(typeof e.ignore_last_delimiters=="number")e.ignore_last_delimiters=Math.floor(e.ignore_last_delimiters),e.ignore_last_delimiters===0&&(e.ignore_last_delimiters=!1);else if(typeof e.ignore_last_delimiters!="boolean")throw new _("CSV_INVALID_OPTION_IGNORE_LAST_DELIMITERS",["Invalid option `ignore_last_delimiters`:","the value must be a boolean value or an integer,",`got ${JSON.stringify(e.ignore_last_delimiters)}`],e);if(e.ignore_last_delimiters===!0&&e.columns===!1)throw new _("CSV_IGNORE_LAST_DELIMITERS_REQUIRES_COLUMNS",["The option `ignore_last_delimiters`","requires the activation of the `columns` option"],e);if(e.info===void 0||e.info===null||e.info===!1)e.info=!1;else if(e.info!==!0)throw new Error(`Invalid Option: info must be true, got ${JSON.stringify(e.info)}`);if(e.max_record_size===void 0||e.max_record_size===null||e.max_record_size===!1)e.max_record_size=0;else if(!(Number.isInteger(e.max_record_size)&&e.max_record_size>=0))if(typeof e.max_record_size=="string"&&/\d+/.test(e.max_record_size))e.max_record_size=parseInt(e.max_record_size);else throw new Error(`Invalid Option: max_record_size must be a positive integer, got ${JSON.stringify(e.max_record_size)}`);if(e.objname===void 0||e.objname===null||e.objname===!1)e.objname=void 0;else if(Buffer.isBuffer(e.objname)){if(e.objname.length===0)throw new Error("Invalid Option: objname must be a non empty buffer");e.encoding===null||(e.objname=e.objname.toString(e.encoding))}else if(typeof e.objname=="string"){if(e.objname.length===0)throw new Error("Invalid Option: objname must be a non empty string")}else if(typeof e.objname!="number")throw new Error(`Invalid Option: objname must be a string or a buffer, got ${e.objname}`);if(e.objname!==void 0){if(typeof e.objname=="number"){if(e.columns!==!1)throw Error("Invalid Option: objname index cannot be combined with columns or be defined as a field")}else if(e.columns===!1)throw Error("Invalid Option: objname field must be combined with columns or be defined as an index")}if(e.on_record===void 0||e.on_record===null)e.on_record=void 0;else if(typeof e.on_record!="function")throw new _("CSV_INVALID_OPTION_ON_RECORD",["Invalid option `on_record`:","expect a function,",`got ${JSON.stringify(e.on_record)}`],e);if(e.on_skip!==void 0&&e.on_skip!==null&&typeof e.on_skip!="function")throw new Error(`Invalid Option: on_skip must be a function, got ${JSON.stringify(e.on_skip)}`);if(e.quote===null||e.quote===!1||e.quote==="")e.quote=null;else if(e.quote===void 0||e.quote===!0?e.quote=Buffer.from('"',e.encoding):typeof e.quote=="string"&&(e.quote=Buffer.from(e.quote,e.encoding)),!Buffer.isBuffer(e.quote))throw new Error(`Invalid Option: quote must be a buffer or a string, got ${JSON.stringify(e.quote)}`);if(e.raw===void 0||e.raw===null||e.raw===!1)e.raw=!1;else if(e.raw!==!0)throw new Error(`Invalid Option: raw must be true, got ${JSON.stringify(e.raw)}`);if(e.record_delimiter===void 0)e.record_delimiter=[];else if(typeof e.record_delimiter=="string"||Buffer.isBuffer(e.record_delimiter)){if(e.record_delimiter.length===0)throw new _("CSV_INVALID_OPTION_RECORD_DELIMITER",["Invalid option `record_delimiter`:","value must be a non empty string or buffer,",`got ${JSON.stringify(e.record_delimiter)}`],e);e.record_delimiter=[e.record_delimiter]}else if(!Array.isArray(e.record_delimiter))throw new _("CSV_INVALID_OPTION_RECORD_DELIMITER",["Invalid option `record_delimiter`:","value must be a string, a buffer or array of string|buffer,",`got ${JSON.stringify(e.record_delimiter)}`],e);if(e.record_delimiter=e.record_delimiter.map(function(t,n){if(typeof t!="string"&&!Buffer.isBuffer(t))throw new _("CSV_INVALID_OPTION_RECORD_DELIMITER",["Invalid option `record_delimiter`:","value must be a string, a buffer or array of string|buffer",`at index ${n},`,`got ${JSON.stringify(t)}`],e);if(t.length===0)throw new _("CSV_INVALID_OPTION_RECORD_DELIMITER",["Invalid option `record_delimiter`:","value must be a non empty string or buffer",`at index ${n},`,`got ${JSON.stringify(t)}`],e);return typeof t=="string"&&(t=Buffer.from(t,e.encoding)),t}),typeof e.relax_column_count!="boolean")if(e.relax_column_count===void 0||e.relax_column_count===null)e.relax_column_count=!1;else throw new Error(`Invalid Option: relax_column_count must be a boolean, got ${JSON.stringify(e.relax_column_count)}`);if(typeof e.relax_column_count_less!="boolean")if(e.relax_column_count_less===void 0||e.relax_column_count_less===null)e.relax_column_count_less=!1;else throw new Error(`Invalid Option: relax_column_count_less must be a boolean, got ${JSON.stringify(e.relax_column_count_less)}`);if(typeof e.relax_column_count_more!="boolean")if(e.relax_column_count_more===void 0||e.relax_column_count_more===null)e.relax_column_count_more=!1;else throw new Error(`Invalid Option: relax_column_count_more must be a boolean, got ${JSON.stringify(e.relax_column_count_more)}`);if(typeof e.relax_quotes!="boolean")if(e.relax_quotes===void 0||e.relax_quotes===null)e.relax_quotes=!1;else throw new Error(`Invalid Option: relax_quotes must be a boolean, got ${JSON.stringify(e.relax_quotes)}`);if(typeof e.skip_empty_lines!="boolean")if(e.skip_empty_lines===void 0||e.skip_empty_lines===null)e.skip_empty_lines=!1;else throw new Error(`Invalid Option: skip_empty_lines must be a boolean, got ${JSON.stringify(e.skip_empty_lines)}`);if(typeof e.skip_records_with_empty_values!="boolean")if(e.skip_records_with_empty_values===void 0||e.skip_records_with_empty_values===null)e.skip_records_with_empty_values=!1;else throw new Error(`Invalid Option: skip_records_with_empty_values must be a boolean, got ${JSON.stringify(e.skip_records_with_empty_values)}`);if(typeof e.skip_records_with_error!="boolean")if(e.skip_records_with_error===void 0||e.skip_records_with_error===null)e.skip_records_with_error=!1;else throw new Error(`Invalid Option: skip_records_with_error must be a boolean, got ${JSON.stringify(e.skip_records_with_error)}`);if(e.rtrim===void 0||e.rtrim===null||e.rtrim===!1)e.rtrim=!1;else if(e.rtrim!==!0)throw new Error(`Invalid Option: rtrim must be a boolean, got ${JSON.stringify(e.rtrim)}`);if(e.ltrim===void 0||e.ltrim===null||e.ltrim===!1)e.ltrim=!1;else if(e.ltrim!==!0)throw new Error(`Invalid Option: ltrim must be a boolean, got ${JSON.stringify(e.ltrim)}`);if(e.trim===void 0||e.trim===null||e.trim===!1)e.trim=!1;else if(e.trim!==!0)throw new Error(`Invalid Option: trim must be a boolean, got ${JSON.stringify(e.trim)}`);if(e.trim===!0&&r.ltrim!==!1?e.ltrim=!0:e.ltrim!==!0&&(e.ltrim=!1),e.trim===!0&&r.rtrim!==!1?e.rtrim=!0:e.rtrim!==!0&&(e.rtrim=!1),e.to===void 0||e.to===null)e.to=-1;else if(typeof e.to=="string"&&/\d+/.test(e.to)&&(e.to=parseInt(e.to)),Number.isInteger(e.to)){if(e.to<=0)throw new Error(`Invalid Option: to must be a positive integer greater than 0, got ${JSON.stringify(r.to)}`)}else throw new Error(`Invalid Option: to must be an integer, got ${JSON.stringify(r.to)}`);if(e.to_line===void 0||e.to_line===null)e.to_line=-1;else if(typeof e.to_line=="string"&&/\d+/.test(e.to_line)&&(e.to_line=parseInt(e.to_line)),Number.isInteger(e.to_line)){if(e.to_line<=0)throw new Error(`Invalid Option: to_line must be a positive integer greater than 0, got ${JSON.stringify(r.to_line)}`)}else throw new Error(`Invalid Option: to_line must be an integer, got ${JSON.stringify(r.to_line)}`);return e},G=function(r){return r.every(e=>e==null||e.toString&&e.toString().trim()==="")},Ne=13,ve=10,B={utf8:Buffer.from([239,187,191]),utf16le:Buffer.from([255,254])},Ee=function(r={}){const e={bytes:0,comment_lines:0,empty_lines:0,invalid_field_length:0,lines:1,records:0},l=H(r);return{info:e,original_options:r,options:l,state:Oe(l),__needMoreData:function(t,n,o){if(o)return!1;const{encoding:s,escape:i,quote:f}=this.options,{quoting:u,needMoreDataSize:c,recordDelimiterMaxLength:h}=this.state,b=n-t-1,R=Math.max(c,h===0?Buffer.from(`\r
`,s).length:h,u?(i===null?0:i.length)+f.length:0,u?f.length+h:0);return b<R},parse:function(t,n,o,s){const{bom:i,comment_no_infix:f,encoding:u,from_line:c,ltrim:h,max_record_size:b,raw:R,relax_quotes:$,rtrim:y,skip_empty_lines:v,to:I,to_line:g}=this.options;let{comment:d,escape:O,quote:S,record_delimiter:J}=this.options;const{bomSkipped:te,previousBuf:T,rawBuffer:ne,escapeIsQuote:ie}=this.state;let m;if(T===void 0)if(t===void 0){s();return}else m=t;else T!==void 0&&t===void 0?m=T:m=Buffer.concat([T,t]);if(te===!1)if(i===!1)this.state.bomSkipped=!0;else if(m.length<3){if(n===!1){this.state.previousBuf=m;return}}else{for(const p in B)if(B[p].compare(m,0,B[p].length)===0){const E=B[p].length;this.state.bufBytesStart+=E,m=m.slice(E),this.options=H({...this.original_options,encoding:p}),{comment:d,escape:O,quote:S}=this.options;break}this.state.bomSkipped=!0}const k=m.length;let a;for(a=0;a<k&&!this.__needMoreData(a,k,n);a++){if(this.state.wasRowDelimiter===!0&&(this.info.lines++,this.state.wasRowDelimiter=!1),g!==-1&&this.info.lines>g){this.state.stop=!0,s();return}this.state.quoting===!1&&J.length===0&&this.__autoDiscoverRecordDelimiter(m,a)&&(J=this.options.record_delimiter);const p=m[a];if(R===!0&&ne.append(p),(p===Ne||p===ve)&&this.state.wasRowDelimiter===!1&&(this.state.wasRowDelimiter=!0),this.state.escaping===!0)this.state.escaping=!1;else{if(O!==null&&this.state.quoting===!0&&this.__isEscape(m,a,p)&&a+O.length<k)if(ie){if(this.__isQuote(m,a+O.length)){this.state.escaping=!0,a+=O.length-1;continue}}else{this.state.escaping=!0,a+=O.length-1;continue}if(this.state.commenting===!1&&this.__isQuote(m,a))if(this.state.quoting===!0){const w=m[a+S.length],x=y&&this.__isCharTrimable(m,a+S.length),N=d!==null&&this.__compareBytes(d,m,a+S.length,w),C=this.__isDelimiter(m,a+S.length,w),A=J.length===0?this.__autoDiscoverRecordDelimiter(m,a+S.length):this.__isRecordDelimiter(w,m,a+S.length);if(O!==null&&this.__isEscape(m,a,p)&&this.__isQuote(m,a+O.length))a+=O.length-1;else if(!w||C||A||N||x){this.state.quoting=!1,this.state.wasQuoting=!0,a+=S.length-1;continue}else if($===!1){const j=this.__error(new _("CSV_INVALID_CLOSING_QUOTE",["Invalid Closing Quote:",`got "${String.fromCharCode(w)}"`,`at line ${this.info.lines}`,"instead of delimiter, record delimiter, trimable character","(if activated) or comment"],this.options,this.__infoField()));if(j!==void 0)return j}else this.state.quoting=!1,this.state.wasQuoting=!0,this.state.field.prepend(S),a+=S.length-1}else if(this.state.field.length!==0){if($===!1){const w=this.__infoField(),x=Object.keys(B).map(C=>B[C].equals(this.state.field.toString())?C:!1).filter(Boolean)[0],N=this.__error(new _("INVALID_OPENING_QUOTE",["Invalid Opening Quote:",`a quote is found on field ${JSON.stringify(w.column)} at line ${w.lines}, value is ${JSON.stringify(this.state.field.toString(u))}`,x?`(${x} bom)`:void 0],this.options,w,{field:this.state.field}));if(N!==void 0)return N}}else{this.state.quoting=!0,a+=S.length-1;continue}if(this.state.quoting===!1){const w=this.__isRecordDelimiter(p,m,a);if(w!==0){if(this.state.commenting&&this.state.wasQuoting===!1&&this.state.record.length===0&&this.state.field.length===0)this.info.comment_lines++;else{if(this.state.enabled===!1&&this.info.lines+(this.state.wasRowDelimiter===!0?1:0)>=c){this.state.enabled=!0,this.__resetField(),this.__resetRecord(),a+=w-1;continue}if(v===!0&&this.state.wasQuoting===!1&&this.state.record.length===0&&this.state.field.length===0){this.info.empty_lines++,a+=w-1;continue}this.info.bytes=this.state.bufBytesStart+a;const C=this.__onField();if(C!==void 0)return C;this.info.bytes=this.state.bufBytesStart+a+w;const A=this.__onRecord(o);if(A!==void 0)return A;if(I!==-1&&this.info.records>=I){this.state.stop=!0,s();return}}this.state.commenting=!1,a+=w-1;continue}if(this.state.commenting)continue;if(d!==null&&(f===!1||this.state.record.length===0&&this.state.field.length===0)&&this.__compareBytes(d,m,a,p)!==0){this.state.commenting=!0;continue}const x=this.__isDelimiter(m,a,p);if(x!==0){this.info.bytes=this.state.bufBytesStart+a;const N=this.__onField();if(N!==void 0)return N;a+=x-1;continue}}}if(this.state.commenting===!1&&b!==0&&this.state.record_length+this.state.field.length>b)return this.__error(new _("CSV_MAX_RECORD_SIZE",["Max Record Size:","record exceed the maximum number of tolerated bytes",`of ${b}`,`at line ${this.info.lines}`],this.options,this.__infoField()));const E=h===!1||this.state.quoting===!0||this.state.field.length!==0||!this.__isCharTrimable(m,a),re=y===!1||this.state.wasQuoting===!1;if(E===!0&&re===!0)this.state.field.append(p);else{if(y===!0&&!this.__isCharTrimable(m,a))return this.__error(new _("CSV_NON_TRIMABLE_CHAR_AFTER_CLOSING_QUOTE",["Invalid Closing Quote:","found non trimable byte after quote",`at line ${this.info.lines}`],this.options,this.__infoField()));E===!1&&(a+=this.__isCharTrimable(m,a)-1);continue}}if(n===!0)if(this.state.quoting===!0){const p=this.__error(new _("CSV_QUOTE_NOT_CLOSED",["Quote Not Closed:",`the parsing is finished with an opening quote at line ${this.info.lines}`],this.options,this.__infoField()));if(p!==void 0)return p}else if(this.state.wasQuoting===!0||this.state.record.length!==0||this.state.field.length!==0){this.info.bytes=this.state.bufBytesStart+a;const p=this.__onField();if(p!==void 0)return p;const E=this.__onRecord(o);if(E!==void 0)return E}else this.state.wasRowDelimiter===!0?this.info.empty_lines++:this.state.commenting===!0&&this.info.comment_lines++;else this.state.bufBytesStart+=a,this.state.previousBuf=m.slice(a);this.state.wasRowDelimiter===!0&&(this.info.lines++,this.state.wasRowDelimiter=!1)},__onRecord:function(t){const{columns:n,group_columns_by_name:o,encoding:s,info:i,from:f,relax_column_count:u,relax_column_count_less:c,relax_column_count_more:h,raw:b,skip_records_with_empty_values:R}=this.options,{enabled:$,record:y}=this.state;if($===!1)return this.__resetRecord();const v=y.length;if(n===!0){if(R===!0&&G(y)){this.__resetRecord();return}return this.__firstLineToColumns(y)}if(n===!1&&this.info.records===0&&(this.state.expectedRecordLength=v),v!==this.state.expectedRecordLength){const I=n===!1?new _("CSV_RECORD_INCONSISTENT_FIELDS_LENGTH",["Invalid Record Length:",`expect ${this.state.expectedRecordLength},`,`got ${v} on line ${this.info.lines}`],this.options,this.__infoField(),{record:y}):new _("CSV_RECORD_INCONSISTENT_COLUMNS",["Invalid Record Length:",`columns length is ${n.length},`,`got ${v} on line ${this.info.lines}`],this.options,this.__infoField(),{record:y});if(u===!0||c===!0&&v<this.state.expectedRecordLength||h===!0&&v>this.state.expectedRecordLength)this.info.invalid_field_length++,this.state.error=I;else{const g=this.__error(I);if(g)return g}}if(R===!0&&G(y)){this.__resetRecord();return}if(this.state.recordHasError===!0){this.__resetRecord(),this.state.recordHasError=!1;return}if(this.info.records++,f===1||this.info.records>=f){const{objname:I}=this.options;if(n!==!1){const g={};for(let d=0,O=y.length;d<O;d++)n[d]===void 0||n[d].disabled||(o===!0&&g[n[d].name]!==void 0?Array.isArray(g[n[d].name])?g[n[d].name]=g[n[d].name].concat(y[d]):g[n[d].name]=[g[n[d].name],y[d]]:g[n[d].name]=y[d]);if(b===!0||i===!0){const d=Object.assign({record:g},b===!0?{raw:this.state.rawBuffer.toString(s)}:{},i===!0?{info:this.__infoRecord()}:{}),O=this.__push(I===void 0?d:[g[I],d],t);if(O)return O}else{const d=this.__push(I===void 0?g:[g[I],g],t);if(d)return d}}else if(b===!0||i===!0){const g=Object.assign({record:y},b===!0?{raw:this.state.rawBuffer.toString(s)}:{},i===!0?{info:this.__infoRecord()}:{}),d=this.__push(I===void 0?g:[y[I],g],t);if(d)return d}else{const g=this.__push(I===void 0?y:[y[I],y],t);if(g)return g}}this.__resetRecord()},__firstLineToColumns:function(t){const{firstLineToHeaders:n}=this.state;try{const o=n===void 0?t:n.call(null,t);if(!Array.isArray(o))return this.__error(new _("CSV_INVALID_COLUMN_MAPPING",["Invalid Column Mapping:","expect an array from column function,",`got ${JSON.stringify(o)}`],this.options,this.__infoField(),{headers:o}));const s=ee(o);this.state.expectedRecordLength=s.length,this.options.columns=s,this.__resetRecord();return}catch(o){return o}},__resetRecord:function(){this.options.raw===!0&&this.state.rawBuffer.reset(),this.state.error=void 0,this.state.record=[],this.state.record_length=0},__onField:function(){const{cast:t,encoding:n,rtrim:o,max_record_size:s}=this.options,{enabled:i,wasQuoting:f}=this.state;if(i===!1)return this.__resetField();let u=this.state.field.toString(n);if(o===!0&&f===!1&&(u=u.trimRight()),t===!0){const[c,h]=this.__cast(u);if(c!==void 0)return c;u=h}this.state.record.push(u),s!==0&&typeof u=="string"&&(this.state.record_length+=u.length),this.__resetField()},__resetField:function(){this.state.field.reset(),this.state.wasQuoting=!1},__push:function(t,n){const{on_record:o}=this.options;if(o!==void 0){const s=this.__infoRecord();try{t=o.call(null,t,s)}catch(i){return i}if(t==null)return}n(t)},__cast:function(t){const{columns:n,relax_column_count:o}=this.options;if(Array.isArray(n)===!0&&o&&this.options.columns.length<=this.state.record.length)return[void 0,void 0];if(this.state.castField!==null)try{const i=this.__infoField();return[void 0,this.state.castField.call(null,t,i)]}catch(i){return[i]}if(this.__isFloat(t))return[void 0,parseFloat(t)];if(this.options.cast_date!==!1){const i=this.__infoField();return[void 0,this.options.cast_date.call(null,t,i)]}return[void 0,t]},__isCharTrimable:function(t,n){return((s,i)=>{const{timchars:f}=this.state;e:for(let u=0;u<f.length;u++){const c=f[u];for(let h=0;h<c.length;h++)if(c[h]!==s[i+h])continue e;return c.length}return 0})(t,n)},__isFloat:function(t){return t-parseFloat(t)+1>=0},__compareBytes:function(t,n,o,s){if(t[0]!==s)return 0;const i=t.length;for(let f=1;f<i;f++)if(t[f]!==n[o+f])return 0;return i},__isDelimiter:function(t,n,o){const{delimiter:s,ignore_last_delimiters:i}=this.options;if(i===!0&&this.state.record.length===this.options.columns.length-1)return 0;if(i!==!1&&typeof i=="number"&&this.state.record.length===i-1)return 0;e:for(let f=0;f<s.length;f++){const u=s[f];if(u[0]===o){for(let c=1;c<u.length;c++)if(u[c]!==t[n+c])continue e;return u.length}}return 0},__isRecordDelimiter:function(t,n,o){const{record_delimiter:s}=this.options,i=s.length;e:for(let f=0;f<i;f++){const u=s[f],c=u.length;if(u[0]===t){for(let h=1;h<c;h++)if(u[h]!==n[o+h])continue e;return u.length}}return 0},__isEscape:function(t,n,o){const{escape:s}=this.options;if(s===null)return!1;const i=s.length;if(s[0]===o){for(let f=0;f<i;f++)if(s[f]!==t[n+f])return!1;return!0}return!1},__isQuote:function(t,n){const{quote:o}=this.options;if(o===null)return!1;const s=o.length;for(let i=0;i<s;i++)if(o[i]!==t[n+i])return!1;return!0},__autoDiscoverRecordDelimiter:function(t,n){const{encoding:o}=this.options,s=[Buffer.from(`\r
`,o),Buffer.from(`
`,o),Buffer.from("\r",o)];e:for(let i=0;i<s.length;i++){const f=s[i].length;for(let u=0;u<f;u++)if(s[i][u]!==t[n+u])continue e;return this.options.record_delimiter.push(s[i]),this.state.recordDelimiterMaxLength=s[i].length,s[i].length}return 0},__error:function(t){const{encoding:n,raw:o,skip_records_with_error:s}=this.options,i=typeof t=="string"?new Error(t):t;if(s){this.state.recordHasError=!0,this.options.on_skip!==void 0&&this.options.on_skip(i,o?this.state.rawBuffer.toString(n):void 0);return}else return i},__infoDataSet:function(){return{...this.info,columns:this.options.columns}},__infoRecord:function(){const{columns:t,raw:n,encoding:o}=this.options;return{...this.__infoDataSet(),error:this.state.error,header:t===!0,index:this.state.record.length,raw:n?this.state.rawBuffer.toString(o):void 0}},__infoField:function(){const{columns:t}=this.options,n=Array.isArray(t);return{...this.__infoRecord(),column:n===!0?t.length>this.state.record.length?t[this.state.record.length].name:null:this.state.record.length,quoting:this.state.wasQuoting}}}},xe=function(r,e={}){typeof r=="string"&&(r=Buffer.from(r));const l=e&&e.objname?{}:[],t=Ee(e),n=f=>{t.options.objname===void 0?l.push(f):l[f[0]]=f[1]},o=()=>{},s=t.parse(r,!1,n,o);if(s!==void 0)throw s;const i=t.parse(void 0,!0,n,o);if(i!==void 0)throw i;return l},Ce="https://raw.githubusercontent.com/Greco1899/scrape_ufc_stats/main/ufc_event_details.csv",De=async({fetch:r})=>{try{const l=await(await r(Ce)).text();return{events:xe(l,{columns:!0,skip_empty_lines:!0}).slice(0,15).map(o=>{const[s,i]=o.EVENT.split(": ");return{event:s,fighters:i,location:o.LOCATION,date:o.DATE}})}}catch(e){return console.error("Error fetching or processing CSV:",e),{error:"Failed to fetch or process data"}}},Je=Object.freeze(Object.defineProperty({__proto__:null,load:De},Symbol.toStringTag,{value:"Module"}));function Re(r){let e,l='<ol id="eventsHTML" class="svelte-12gzot0"></ol>';return{c(){e=q("div"),e.innerHTML=l,this.h()},l(t){e=M(t,"DIV",{id:!0,class:!0,"data-svelte-h":!0}),W(e)!=="svelte-15k4i5v"&&(e.innerHTML=l),this.h()},h(){D(e,"id","cardsContainer"),D(e,"class","svelte-12gzot0")},m(t,n){F(t,e,n)},p:V,i:V,o:V,d(t){t&&L(e)}}}function Be(r,e,l){let{data:t={events:[]}}=e;return Z(async()=>{const n=document.getElementById("section1");n&&(n.style.height="300vh");let o=[];o=t.events||[];const s=document.getElementById("eventsHTML");s&&(s.style.opacity="0"),o.forEach(i=>{const f=document.createElement("li");f.id="card",[{id:"event",text:i.event},{id:"fighters",text:i.fighters},{id:"date",text:i.date},{id:"location",text:i.location}].forEach(({id:c,text:h})=>{const b=document.createElement("p");b.id=c,b.innerText=h,f.appendChild(b)}),s==null||s.appendChild(f)}),s&&setTimeout(()=>{s.style.transition="opacity 0.35s",s.style.opacity="1",n&&(n.style.height="auto")},25)}),r.$$set=n=>{"data"in n&&l(0,t=n.data)},[t]}class Le extends X{constructor(e){super(),K(this,e,Be,Re,Y,{data:0})}}function $e(r){let e,l,t,n,o="UFC Events",s,i,f,u;return f=new Le({}),{c(){e=q("meta"),l=P(),t=q("div"),n=q("h1"),n.textContent=o,i=P(),oe(f.$$.fragment),this.h()},l(c){const h=le("svelte-17938xx",document.head);e=M(h,"META",{name:!0,content:!0}),h.forEach(L),l=Q(c),t=M(c,"DIV",{id:!0,class:!0});var b=fe(t);n=M(b,"H1",{class:!0,"data-svelte-h":!0}),W(n)!=="svelte-qqiki"&&(n.textContent=o),i=Q(b),ae(f.$$.fragment,b),b.forEach(L),this.h()},h(){document.title="UFC",D(e,"name","description"),D(e,"content","About this app"),D(n,"class","svelte-111q57o"),D(t,"id","section1"),D(t,"class","svelte-111q57o")},m(c,h){z(document.head,e),F(c,l,h),F(c,t,h),z(t,n),z(t,i),ue(f,t,null),u=!0},p:V,i(c){u||(c&&(s||se(()=>{s=me(n,he,{y:-50,duration:500}),s.start()})),ce(f.$$.fragment,c),u=!0)},o(c){_e(f.$$.fragment,c),u=!1},d(c){c&&(L(l),L(t)),L(e),de(f)}}}function Te(r){return Z(async()=>{}),[]}class ke extends X{constructor(e){super(),K(this,e,Te,$e,Y,{})}}export{ke as component,Je as universal};
